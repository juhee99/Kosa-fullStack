<img src="https://noticon-static.tammolo.com/dgggcrkxq/image/upload/v1566778017/noticon/ytjm1rralodyhvuggrpu.png" height="15%" width="15%"> <br/>

# 2023-04-28 /Log

π—“οΈ λ‚ μ§β€β€β€β€β€β€β€β€β€β€β€2023/04/28

βοΈ λ‚ μ”¨β€β€β€β€β€β€β€β€β€β€β€β€οΈ λ§‘μ (17Β°C)

## 01. νΌμ‚¬λ“ ν¨ν„΄

π’΅ νΌμ‚¬λ“ ν¨ν„΄(μ™Έκ΄€ ν¨ν„΄)μ€ μ†ν”„νΈμ›¨μ–΄ κ³µν•™ λ””μμΈ ν¨ν„΄ μ¤‘ ν•λ‚μ΄λ‹¤.

- κ°μ²΄ μ§€ν–¥ ν”„λ΅κ·Έλλ° λ¶„μ•Όμ— μμ£Ό μ‚¬μ©λλ‹¤.
- λ³µμ΅ν• μ„λΈ μ‹μ¤ν… `μμ΅΄μ„±μ„ μµμ†ν™”`ν•λ” ν¨ν„΄μ΄λ‹¤.
- μ„λΈ μ‹μ¤ν…μ— μλ” μΈν„°νμ΄μ¤λ“¤μ— λ€ν• ν†µν•© μΈν„°νμ΄μ¤λ¥Ό μ κ³µν•μ—¬ μ„λΈ μ‹μ¤ν…μ„ λ” μ‰½κ² κ·Έλ¦¬κ³  `μΌκ΄€μ„±` μκ² μ‚¬μ©ν•  μ μλ„λ΅ λ§λ“λ” `λ” λ†’μ€ μμ¤€μ μΈν„°νμ΄μ¤`λ¥Ό λ§ν•λ‹¤.

## 02. SLF4J

π’΅ SLF4Jλ” λ‹¨μν• νΌμ‚¬λ“ ν¨ν„΄μ„ μλ‹¨μΌλ΅ ν•λ” μλ°” λ΅κΉ… APIλ¥Ό μ κ³µν•λ‹¤. μ¦‰, μ—¬λ¬ λ‹¤μ–‘ν• λ΅κ·Έ λΌμ΄λΈλ¬λ¦¬λ“¤μ ν†µν•©λ μΈν„°νμ΄μ¤λ¥Ό μ κ³µν•λ” κ²ƒ

<img src="https://user-images.githubusercontent.com/55836020/235413763-f90dd1fc-84d8-4240-b505-29121d884bfb.png" width="50%">

- μ¤ν”„λ§ λ¶€νΈμ—μ„λ” μ¤ν”„μΌ λ¶€νΈ λ΅κΉ… λΌμ΄λΈλ¬λ¦¬ spring-boot-starter-loggingκ°€ ν•¨κ» ν¬ν•¨λλ©° logback,log4j κ°€ ν¬ν•¨λλ‹¤.
- springμ λ””ν΄νΈ loglevelμ€ info μ΄λ‹¤.
- μ¤ν”„λ§ λ΅κ·Έ λ λ²¨ μ„¤μ •μ€ application.propertiesνμΌμ— λ΅κ·Έλ λ²¨μ„ μ„¤μ • ν•λ‹¤.
    - logging.level.org.springframework.web=debug

### 2.1 λ΅κ·Έ λ λ²¨

<img src="https://user-images.githubusercontent.com/55836020/235413759-ba258732-0fc5-450b-b222-eb21e973135f.png" width="50%">

- κ°λ° μ„λ²„λ” DEBUG λ λ²¨μ„ μ„¤μ •, μ΄μ μ„λ²„λ” INFOλ λ²¨

## 03. SQL λ΅κ·Έ λ‚¨κΈ°κΈ°

π’΅ log4jdbcλΌλ” SQL λ΅κΉ…μ„ μ„ν• JDBCν”„λ½μ‹ λ“λΌμ΄λ²„λ¥Ό μ‚¬μ©ν•λ‹¤.

### 3.1 ν™κ²½ μ„¤μ •

1.**[ build.gradle ]**

- implementation 'org.bgee.log4jdbc-log4j2:log4jdbc-log4j2-jdbc4.1:1.16β€™
1. **application.properties μ— JDBC λ“λΌμ΄λ²„ μ •λ³΄μ™€ urlμ •λ³΄λ¥Ό λ³€κ²½**
    - spring.datasource.url: jdbc:log4jdbc:mysql://localhost:3306/edudb?characterEncoding=UTF8&serverTimezone=UTC
    - spring.datasource.driver-class-name=net.sf.log4jdbc.sql.jdbcapi.DriverSpy
2. **log4jdbc.log4j2.properties νμΌμ„ μƒμ„±**
    - log4jdbc.spylogdelegator.name=net.sf.log4jdbc.log.slf4j.Slf4jSpyLogDelegator
    - log4jdbc.dump.sql.maxlinelength=0
3. 

## 04. Mapper νμΌ λ™μ μΌλ΅ λ§λ“¤κΈ°

π’΅ μ»¬λΌλ…μ΄λ‚ ν…μ΄λΈ”μ„ λ™μ μΌλ΅ λ°›μ•„ μ…‹ν… ν•κ³  μ‹¶μ„ λ• ${} μ‚¬μ©

- #{xxx} β†’ β€xxxβ€™ , λ‹¨μΌ μΈμ© λ¶€νΈ o
- ${xxx} β†’ xxx  , λ‹¨μΌ μΈμ© λ¶€νΈ x

### 4.1 μμ 

```sql
select name, schoolname, addr from ${tablename} where ${colname} = #{colvalue}
μ2)
select id, name, writedate, memo from visitor where memo like  concat('%',#{key},'%')
select id, name, writedate, memo from visitor where memo like '%${key}%'
```

## 05. mybatis μ–΄λ…Έν…μ΄μ… μ²λ¦¬

π’΅ Mybatis 3.0 λ¶€ν„° xmlλ΅ μ‘μ„±ν•λ” λ§¤νΌ νμΌ λ€μ‹  μλ°” ν΄λμ¤ λλ” μΈν„°νμ΄μ¤μ— μ‘μ„±λλ” μ• λ…Έν…μ΄μ…μΌλ΅ λ€μ‹ ν•  μ μλ‹¤.

- μ• λ…Έν…μ΄μ…μΌλ΅ μ²λ¦¬ν•λ ¤λ” κ²½μ°μ—λ” μ¤ν”„λ§ λ¶€νΈ application ν”„λ΅κ·Έλ¨μ— @MapperScanμ— λ€ν• μ •λ³΄λ¥Ό μ‘μ„±ν•΄μ•Όν•λ‹¤.
- @MapperScan(value={"com.example.springedu.dao"})

### 5.1 κµ¬ν„ λ°©λ²•

1. μ• λ…Έν…μ΄μ…κ³Ό SQL μ΄ μ •μλ μΈν„°νμ΄μ¤(λ§¤νΌ μΈν„°νμ΄μ¤)
2. μ• λ…Έν…μ΄μ…μ΄ μ •μλ μΈν„°νμ΄μ¤+SQLμ΄ μ •μλ λ§¤νΌνμΌ
3. μ• λ…Έν…μ΄μ…μ΄ μ •μλ μΈν„°νμ΄μ¤+SQLκ³Ό μ• λ…Έν…μ΄μ…μ΄ μ •μλ λ§¤νΌ ν΄λμ¤

### 5.2 μμ  - μ²«λ²μ§Έ λ°©λ²•

```java
@Mapper
public interface EmpMapperDAO {
 @Select("select count(*) from emp")
 public int getAllDataNum();
 @Select("select empno, ename, job, date_format(hiredate, '%Yλ…„ %mμ›” %dμΌ') hiredate, 
sal from emp")
 public List<EmpVO> listAll();
 @Select("select empno, ename, job, date_format(hiredate, '%Yλ…„ %mμ›” %dμΌ') hiredate, 
sal from emp order by sal limit #{startNum}, #{countNum}")
 public List<EmpVO> listPart(PageDTO vo);
}
```

## π¤·β€β™€οΈ **todayβ€™s feeling**

- κ°•μ‚¬λ‹μ΄ λ””μμΈ ν¨ν„΄ λ‚μ¤‘μ— κ³µλ¶€ν•΄ λ³΄λ” κ²ƒ μ¶”μ² β†’ λ””μμΈν¨ν„΄(24κ°)
