<img src="https://noticon-static.tammolo.com/dgggcrkxq/image/upload/v1566778017/noticon/ytjm1rralodyhvuggrpu.png" height="15%" width="15%"> <br/>

# 2023-04-27 / logback

ğŸ—“ï¸ ë‚ ì§œâ€â€â€â€â€â€â€â€â€â€â€2023/05/10

â˜ï¸ ë‚ ì”¨â€â€â€â€â€â€â€â€â€â€ ğŸŒ¥ï¸ íë¦¼ (10Â°C)
</br>

## spring 2 ë‹¨ê³„ í•™ìŠµ

- ë¡œê·¸ : LogBack - ì„¤ì •íŒŒì¼
- Scheduling
- Filter & Interceptor  : ë‘ ê°œì˜ ì°¨ì´
- ì—ëŸ¬ ì²˜ë¦¬
- AOP
- JPA
- Spring Data JPA
- Spring Security
- Spring Rest
- (Spring Test) ì „ì²´ì ìœ¼ë¡œ ë³‘í–‰
- 

## ë¡œê·¸ ë ˆë²¨

`TRACE < DEBUG < INFO < WARN < ERROR`

1. ERROR : ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê²½ìš° í‘œì‹œí•œë‹¤.
2. WARN : ì²˜ë¦¬ ê°€ëŠ¥í•œ ë¬¸ì œ, í–¥í›„ ì‹œìŠ¤í…œ ì—ëŸ¬ì˜ ì›ì¸ì´ ë  ìˆ˜ ìˆëŠ” ê²½ê³ ì„± ë©”ì‹œì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
3. INFO : ìƒíƒœë³€ê²½ê³¼ ê°™ì€ ì •ë³´ì„± ë¡œê·¸ë¥¼ í‘œì‹œí•œë‹¤.
4. DEBUG : í”„ë¡œê·¸ë¨ì„ ë””ë²„ê¹…í•˜ê¸° ìœ„í•œ ì •ë³´ë¥¼ í‘œì‹œí•œë‹¤.
5. TRACE : Debug ë³´ë‹¤ í›¨ì”¬ ìƒì„¸í•œ ì •ë³´ë¥¼ í‘œì‹œí•œë‹¤. (ì²˜ë¦¬ íë¦„ì„ ì¶”ì í•˜ê¸° ìœ„í•¨)

### ë¡œê¹… ë ˆë²¨ ë³€ê²½

- springì˜ ê¸°ë³¸ ë ˆë²¨ ë³€ê²½
    - logging.level.root=info (default)
- íŒ¨í‚¤ì§€ë³„ ë¡œê¹… ë ˆë²¨ ì§€ì •
    - application.properties íŒŒì¼ì— íŒ¨í‚¤ì§€ë³„ë¡œ ë¡œê¹…ë ˆë²¨ ì„¤ì •
    - ex)logging.level.org.springframwork.web = debug


## logback-spring.xml ì„¤ì •

- ëŒ€ì†Œë¬¸ìëŠ” êµ¬ë¶„í•˜ì§€ ì•ŠëŠ”ë‹¤.
- name-attribute ë¥¼ ë°˜ë“œì‹œ ì§€ì •í•´ì•¼ í•œë‹¤.
- logback-spring.xmlì€ appenderì™€ logger í¬ê²Œ ë‘ê°œ ë¡œ êµ¬ë¶„ëœë‹¤.
- Dynamic Reloadingê¸°ëŠ¥ ì§€ì› -  60ì´ˆë§ˆë‹¤ ë¡œê·¸íŒŒì¼ ë³€í™” ê²€ì‚¬

### appenderì˜ class ì¢…ë¥˜

ğŸ’¡ ë¡œê·¸ ë©”ì‹œì§€ê°€ ì¶œë ¥ ë  ëŒ€ìƒì„ ê²°ì •í•˜ëŠ” ìš”ì†Œì´ë‹¤.

- ch.qos.logback.core.ConsoleAppender : ì½˜ì†”ì— ë¡œê·¸ë¥¼ ì°ìŒ
- ch.qos.logback.core.FileAppender : íŒŒì¼ì— ë¡œê·¸ë¥¼ ì°ìŒ
- ch.qos.logback.core.rolling.RollingFileAppender : ì—¬ëŸ¬ê°œì˜ íŒŒì¼ì— ë¡¤ë§,ìˆœíšŒ í•˜ë©´ì„œ ë¡œê·¸ë¥¼ ì°ìŒ (ì¼ì • ìš©ëŸ‰ì´ ë„˜ì–´ê°ˆë•Œ ìƒˆë¡œìš´ íŒŒì¼, ì¼ë³„)

```xml
<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
	 <layout class="ch.qos.logback.classic.PatternLayout">
		 <pattern>[%d{yyyy-MM-dd HH:mm:ss}][%thread] %-5level %logger{36} - %msg%n</pattern>
	 </layout>
 </appender>
 <appender name="FILE" class="ch.qos.logback.core.FileAppender">
		<file>${LOGS_ABSOLUTE_PATH}/mylogback.log</file>
	 <encoder>
		 <pattern>[%d{yyyy-MM-dd HH:mm:ss}] %-5level %logger{35} - %msg%n</pattern>
	 </encoder>
 </appender>
 <appender name="ROLLINGFILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
	 <encoder>
		 <pattern>[%d{yyyy-MM-dd HH:mm:ss}:%-3relative][%thread] %-5level %logger{35} 
- %msg%n</pattern>
	 </encoder>
	 <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"> //ì¼ì ë³„ë¡œ ë¡œê·¸íŒŒì¼ì„ ë§Œë“ ë‹¤
		 <fileNamePattern>${LOGS_ABSOLUTE_PATH}/logback.%d{yyyy-MM-dd}.log</fileNamePattern> // íŒŒì¼ ë„¤ì„ ì„¤ì •
	 </rollingPolicy>
 </appender>
```

- logger{n} : íŒ¨í‚¤ì§€ëª…ì„ nê°œ ë¬¸ìë¡œ ë³´ì—¬ì¤€ë‹¤(ì•½ì–´ë¡œ í‘œí˜„)

### root ì™€ logger

ğŸ’¡ packageì™€ levelì„ ì„¤ì •í•˜ê³  appender ë¥¼ ì°¸ì¡°í•˜ê²Œ ì •ì˜í•œë‹¤.

- **[ root ]**
    - ì „ì—­ ë¡œê±° ì„¤ì •ì´ë‹¤.
    - í•­ìƒ ë§ˆì§€ë§‰ì— ìˆ˜í–‰ë˜ëŠ” ê¸°ë³¸ ë¡œê±°ì´ë‹¤.
    - rootë¡œê·¸ëŠ” ê¼­ ìˆì–´ì•¼ í•œë‹¤.
- **[ logger ]**
    - ì§€ì—­ ë¡œê±° ì„¤ì •ì´ë‹¤.
    - additivity ì†ì„± (default = true) : root ì„¤ì •ì„ ë§ˆì € ìˆ˜í–‰í•  ê²ƒì¸ì§€ì˜ ì—¬ë¶€ë¥¼ ê²°ì • ê°€ëŠ¥

```xml
<root level="INFO">
	 <appender-ref ref="STDOUT" />
 </root>
 <logger name="com.example.springedu.controller.LogTestController1" level="DEBUG">
	 <appender-ref ref="STDOUT" /> //appenderì™€ ì—°ê²°ë¨
	 <appender-ref ref="ROLLINGFILE" />
 </logger>
 <logger name="com.example.springedu.controller.LogTestController2" level="TRACE" additivity="false">
	 <appender-ref ref="STDOUT" />
	 <appender-ref ref="FILE" />
 </logger>
```

